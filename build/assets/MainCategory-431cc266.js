import{K as o,r as a,i as D,k as L,j as s,x as z,L as b,e as P}from"./index-70997a97.js";const Q=({datas:g,get_category_id:j,setCategory_last_id:w,handleChange:C,handleBlur:T,values:I,errors:p,touched:m})=>{Q.propTypes={datas:o.arrayOf(o.shape({product_category_id:o.string.isRequired,product_category_title:o.string.isRequired})).isRequired,get_category_id:o.func.isRequired,isloading:o.func.isRequired,setCategory_last_id:o.array.isRequired};const[l,i]=a.useState(!1),[t,n]=a.useState([]),x=a.useRef(null);a.useEffect(()=>{const e=r=>{x.current&&!x.current.contains(r.target)&&i(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[l]);const k=a.useCallback(()=>{i(!0),j()},[l]),[_,N]=a.useState(1),R=e=>P({url:`datas/get_sub_product_categories/${_}`,method:"post",data:e}),y=D(),{mutate:v,isLoading:q}=L(R,{onSuccess:e=>{var r;E((r=e==null?void 0:e.data)==null?void 0:r.data),y.invalidateQueries("chilldren_category")},onError:e=>{console.log(e)},retry:{maxAttempts:3,delay:e=>e*1e3}}),[h,E]=a.useState(a.useMemo(()=>{const e=y.getQueryData("chilldren_category");return e?e.data:null},[y])),d=a.useCallback((e,r)=>{if(!t.some(c=>c.category_id===r)){const c={option:e,category_id:r};n([...t,c]),w([...t,c])}const f=new FormData;f.append("parent_category_id",r),v(f),N(c=>c+1)},[t,_]),S=a.useCallback((e,r,u)=>{e.preventDefault(),d(r,u)},[]);return s.jsxs("div",{className:" w-full sm:w-[85%] relative",children:[s.jsxs("div",{className:"w-full my-2 P-4 h-10 py-[12px] text-sm border border-gray-300 hover:border-black rounded-sm placeholder:text-gray-400 flex justify-between items-center  ",onClick:k,children:[s.jsx("div",{onChange:C,children:t?t.map((e,r)=>s.jsxs("button",{type:"button",className:`mx-2 z-10 ${r!==3?"hover:underline":" cursor-not-allowed"} `,onClick:u=>{S(u,e.option,e.category_id),r===0?n([t[0]]):r<t.length-1&&n(t.slice(0,r+1))},children:[r+1,":",e.option]},e.category_id)):"Select an option"}),(t==null?void 0:t.length)>0?s.jsx(z,{className:"text-2xl !cursor-pointer mx-2 z-10",onClick:()=>{d(),n([])}}):""]}),(m==null?void 0:m.category_id)&&t&&s.jsx("p",{className:"text-red-500 text-sm text-left sm:text-center capitalize",children:p==null?void 0:p.category_id}),l&&s.jsx("div",{className:"fixed bottom-0 top-0 right-0 left-0  ",onClick:()=>i(!1)}),(l||(t==null?void 0:t.length)>0)&&(t==null?void 0:t.length)!==4&&s.jsx("div",{className:"absolute mt-1 w-full z-10 bg-white border border-gray-300 rounded-md shadow-sm  h-[300px] overflow-y-auto whitespace-nowrap",children:q?s.jsx("div",{className:" h-full w-full grid place-items-center  bg-white",children:s.jsx(b,{})}):s.jsx("ul",{children:h&&h.length>0?h.map(e=>s.jsx("li",{className:"p-2 hover:bg-gray-100 cursor-pointer",onClick:()=>{d(e.product_category_title,e.product_category_id),i(!1)},children:e.product_category_title},+e.product_category_id)):g&&g.length>0&&t.length==0?g.map(e=>s.jsx("li",{className:"p-2 hover:bg-gray-100 cursor-pointer",onClick:()=>{d(e.product_category_title,e.product_category_id),i(!1)},children:e.product_category_title},e.product_category_id)):s.jsx("div",{className:" h-[300px] w-full grid place-items-center  bg-white",children:s.jsx(b,{})})})})]})};export{Q as default};
