import{r,i as $,k as O,j as a,L as E,a3 as G,f as J,p as d,e as _}from"./index-70997a97.js";const U=({category_last_id:i,attributesID:g,setAttributeID:f})=>{var k;const[n,u]=r.useState([]),[j,p]=r.useState([]),[m,y]=r.useState(""),[h,b]=r.useState([]),[A,L]=r.useState([]),w=r.useRef([]),I=r.useCallback((e,t)=>{L(s=>{const l=[...s];return l[t]=!1,l}),b(s=>{const l=[...s];return l[t]=e.target.value,l})},[]),z=r.useCallback(e=>{b(t=>{const s=[...t];return s[e]="",s}),u(t=>{const s=[...t];return s[e]=!1,s})},[]),F=r.useCallback(e=>{u(t=>{const s=[...t];return s[e]=!1,s}),p(t=>{const s=[...t];return s[e]=h[e],s}),b(t=>{const s=[...t];return s[e]="",s})},[h]);r.useEffect(()=>{const e=(s,l)=>{w.current[l]&&!w.current[l].contains(s.target)&&u(c=>{const o=[...c];return o[l]=!1,o})},t=s=>{for(let l=0;l<n.length;l++)e(s,l)};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[n]);const M=r.useCallback((e,t,s,l)=>{p(c=>{const o=[...c];return o[t]=e,o}),f([...g,[s,l]]),y(""),u(c=>{const o=[...c];return o[t]=!1,o})},[g,f]),D=r.useCallback(e=>{y(e.target.value)},[]),R=e=>_({url:"/datas/get_product_category_attributes",method:"post",data:e}),N=$(),Q=O(R,{onSuccess:e=>{T(e.data.product_attributes_data),N.invalidateQueries("category_4_id")},onError:e=>{console.log(e)},retry:{maxAttempts:3,delay:e=>e*1e3}}),[C,T]=r.useState([]),[q,P]=r.useState(!0);r.useEffect(()=>{var t;const e=new FormData;e.append("category_4_id",i&&((t=i[3])==null?void 0:t.category_id)),Q.mutate(e),P(!1)},[i&&((k=i[3])==null?void 0:k.category_id)]);const V=e=>_({url:"/datas/get_product_attribute_values",method:"post",data:e}),{mutate:v,isLoading:B}=O(V,{onSuccess:e=>{var t;console.log(e),H((t=e==null?void 0:e.data)==null?void 0:t.data),N.invalidateQueries("product_attribute_id")},onError:e=>{console.log(e)},retry:{maxAttempts:3,delay:e=>e*1e3}}),S=r.useCallback((e,t)=>{console.log(t);const s=new FormData;s.append("product_attribute_id",t),(async()=>{try{await v(s)}catch(c){console.log(c)}})(),u(c=>{const o=[...c];return o[e]=!o[e],o}),p(c=>{const o=[...c];return o[e]="",o})},[v]),[x,H]=r.useState([]),Y=r.useMemo(()=>x&&x.filter(e=>e.title.toLowerCase().includes(m.toLowerCase())),[x,m]);return q?a.jsx("div",{className:"h-screen w-full grid place-items-center fixed z-20 top-0 right-0 bottom-0 left-0 bg-white",children:a.jsx(E,{})}):a.jsx("div",{className:"grid grid-cols-1 w-full gap-x-10 gap-y-4 items-center c500:grid-cols-2",children:C&&C.map((e,t)=>a.jsx(r.Fragment,{children:a.jsxs("label",{htmlFor:"Fabric",className:"w-full ",children:[a.jsxs("p",{children:[e.title," ",a.jsx("span",{className:"text-red-500 text-xl"})]}),a.jsxs("div",{className:"relative",children:[a.jsxs("div",{className:"w-full my-2 p-2 py-[10px] text-sm border border-gray-300 hover:border-black rounded-sm placeholder:text-gray-400 flex justify-between items-center",onClick:()=>S(t,+e.id),children:[a.jsx("div",{className:"capitalize",children:j[t]?j[t]:"Select an option"}),a.jsx(G,{className:`${n[t]?"rotate-180":""}`})]}),n[t]&&a.jsx("div",{className:"fixed bottom-0 top-0 right-0 left-0 z-10 opacity-20",onClick:()=>S(t)}),n[t]&&a.jsxs("div",{className:"absolute mt-1 w-full z-10 bg-white border border-gray-300 rounded-md shadow-sm  h-[300px] overflow-y-auto whitespace-nowrap",children:[a.jsxs("div",{className:"w-full sticky top-0 z-10 flex items-center px-2 border-b border-gray-300 bg-white",children:[a.jsx(J,{className:"text-xl text-cyan-600"}),a.jsx("input",{type:"text",className:"w-full p-2 focus:outline-none ",placeholder:"Search...",value:m,onChange:D})]}),B?a.jsx("div",{className:" h-[200px] w-full grid place-items-center  bg-white",children:a.jsx(E,{})}):a.jsx("ul",{children:Y.map(s=>a.jsx("li",{className:"p-2 hover:bg-gray-100 cursor-pointer",onClick:()=>M(s.title,t,e.id,s.id),children:s.title},s.id))}),a.jsxs(d.Menu,{dismiss:{itemPress:A[t]},children:[a.jsx(d.MenuHandler,{children:a.jsx("p",{className:"p-2 sticky bottom-0 bg-white cursor-pointer",children:"Other"})}),a.jsxs(d.MenuList,{className:"z-20 w-[270px]",children:[a.jsxs("h1",{className:"mx-2 text-lg my-2 hover:outline-none",children:["Add Your ",e.title," Name"]}),a.jsx(d.Input,{placeholder:"Fabric Name",onChange:s=>I(s,t),value:h[t],containerProps:{className:"mb-4 focus:outline-none"},className:"focus:outline-none input-border capitalize"}),a.jsxs("div",{className:"flex justify-between mt-10 hover:outline-none",children:[" ",a.jsx("button",{className:"btn2 pt-1 pb-[5px] text-sm",onClick:()=>z(t),children:"Clear"})," ",a.jsx("button",{className:"btn1 pt-1 pb-[7px] text-sm",onClick:()=>F(t),children:"Apply"})," "]})]})]})]})]})]})},e.id))})};export{U as default};
