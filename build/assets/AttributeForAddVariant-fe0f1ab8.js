import{r,i as H,k as S,j as a,a3 as Y,f as $,p as i,e as k}from"./index-70997a97.js";const K=({category_last_id:g,attributesID:f,setAttributeID:y,data:d})=>{const[c,u]=r.useState([]),[j,p]=r.useState([]),[m,w]=r.useState(""),[h,b]=r.useState([]),[O,E]=r.useState([]),C=r.useRef([]),A=r.useCallback((e,t)=>{E(s=>{const n=[...s];return n[t]=!1,n}),b(s=>{const n=[...s];return n[t]=e.target.value,n})},[]),L=r.useCallback(e=>{b(t=>{const s=[...t];return s[e]="",s}),u(t=>{const s=[...t];return s[e]=!1,s})},[]),F=r.useCallback(e=>{u(t=>{const s=[...t];return s[e]=!1,s}),p(t=>{const s=[...t];return s[e]=h[e],s}),b(t=>{const s=[...t];return s[e]="",s})},[h]);r.useEffect(()=>{const e=(s,n)=>{C.current[n]&&!C.current[n].contains(s.target)&&u(l=>{const o=[...l];return o[n]=!1,o})},t=s=>{for(let n=0;n<c.length;n++)e(s,n)};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[c]);const I=r.useCallback((e,t,s,n)=>{p(l=>{const o=[...l];return o[t]=e,o}),y([...f,[s,n]]),w(""),u(l=>{const o=[...l];return o[t]=!1,o})},[f,y]),z=r.useCallback(e=>{w(e.target.value)},[]),M=e=>k({url:"/datas/get_product_category_attributes",method:"post",data:e}),N=H(),D=S(M,{onSuccess:e=>{R(e.data.product_attributes_data),N.invalidateQueries("category_4_id")},onError:e=>{console.log(e)},retry:{maxAttempts:3,delay:e=>e*1e3}}),[G,R]=r.useState([]),[Q,T]=r.useState(!0);r.useEffect(()=>{const e=new FormData;e.append("category_4_id",g),D.mutate(e),T(!1)},[g]);const V=e=>k({url:"/datas/get_product_attribute_values",method:"post",data:e}),{mutate:v,isLoading:q}=S(V,{onSuccess:e=>{var t;console.log(e),P((t=e==null?void 0:e.data)==null?void 0:t.data),N.invalidateQueries("product_attribute_id")},onError:e=>{console.log(e)},retry:{maxAttempts:3,delay:e=>e*1e3}}),_=r.useCallback((e,t)=>{const s=new FormData;s.append("product_attribute_id",t),(async()=>{try{await v(s)}catch(l){console.log(l)}})(),u(l=>{const o=[...l];return o[e]=!o[e],o}),p(l=>{const o=[...l];return o[e]="",o})},[v]),[x,P]=r.useState([]),B=r.useMemo(()=>x&&x.filter(e=>e.title.toLowerCase().includes(m.toLowerCase())),[x,m]);return Q||q?a.jsx("h2",{className:"text-5xl text-red-500 h-screen flex justify-center  items-center",children:"Loading..."}):(console.log(d),a.jsx("div",{className:"grid grid-cols-1 w-full gap-x-10 gap-y-4 items-center c500:grid-cols-2",children:d&&d.map((e,t)=>a.jsx(r.Fragment,{children:a.jsxs("label",{htmlFor:"Fabric",className:"w-full ",children:[a.jsxs("p",{children:[e.name," ",a.jsx("span",{className:"text-red-500 text-xl"})]}),a.jsxs("div",{className:"relative",children:[a.jsxs("div",{className:"w-full my-2 p-2 py-[10px] text-sm border border-gray-300 hover:border-black rounded-sm placeholder:text-gray-400 flex justify-between items-center",onClick:()=>_(t,+e.product_attribute_id),children:[a.jsx("div",{className:"capitalize",children:j[t]?j[t]:e.value}),a.jsx(Y,{className:`${c[t]?"rotate-180":""}`})]}),c[t]&&a.jsx("div",{className:"fixed bottom-0 top-0 right-0 left-0 ",onClick:()=>_(t)}),c[t]&&a.jsxs("div",{className:"absolute mt-1 w-full z-10 bg-white border border-gray-300 rounded-md shadow-sm  h-[300px] overflow-y-auto whitespace-nowrap",children:[a.jsxs("div",{className:"w-full sticky top-0 z-10 flex items-center px-2 border-b border-gray-300 bg-white",children:[a.jsx($,{className:"text-xl text-cyan-600"}),a.jsx("input",{type:"text",className:"w-full p-2 focus:outline-none ",placeholder:"Search...",value:m,onChange:z})]}),a.jsx("ul",{children:B.map(s=>a.jsx("li",{className:"p-2 hover:bg-gray-100 cursor-pointer",onClick:()=>I(s.title,t,e.id,s.id),children:s.title},s.id))}),a.jsxs(i.Menu,{dismiss:{itemPress:O[t]},children:[a.jsx(i.MenuHandler,{children:a.jsx("p",{className:"p-2 sticky bottom-0 bg-white cursor-pointer",children:"Other"})}),a.jsxs(i.MenuList,{className:"z-20 w-[270px]",children:[a.jsxs("h1",{className:"mx-2 text-lg my-2 hover:outline-none",children:["Add Your ",e.title," Name"]}),a.jsx(i.Input,{placeholder:"Fabric Name",onChange:s=>A(s,t),value:h[t],containerProps:{className:"mb-4 focus:outline-none"},className:"focus:outline-none input-border capitalize"}),a.jsxs("div",{className:"flex justify-between mt-10 hover:outline-none",children:[" ",a.jsx("button",{className:"btn2 pt-1 pb-[5px] text-sm",onClick:()=>L(t),children:"Clear"})," ",a.jsx("button",{className:"btn1 pt-1 pb-[7px] text-sm",onClick:()=>F(t),children:"Apply"})," "]})]})]})]})]})]})},e.id))}))};export{K as default};
