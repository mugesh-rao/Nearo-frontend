import{r as i,_ as X,v as Z,w as v,b as ee,h as se,i as te,k as M,j as e,f as re,n as ne,x as oe,y as A,T as R,p as S,z as ie,e as C}from"./index-70997a97.js";import{I as de}from"./index.esm-39fce067.js";import{O as ce,A as le,a as ae,d as me,b as pe}from"./OrderSkeleton-269513a0.js";import{I as xe}from"./index.es-9acb4e93.js";import{L as he}from"./LazyLoadImage-edf60663.js";import{P as _e,B as ye}from"./Bill-652105e9.js";import"./Skeleton-1722e138.js";const P=i.lazy(()=>X(()=>import("./index-70997a97.js").then(d=>d.bC),["assets/index-70997a97.js","assets/index-52a015f8.css"])),Ae=()=>{const d={padding:"7px 20px",borderRadius:"10px",border:"none",background:" #E8F5E9",color:"#0ab855"},y={padding:"7px 20px",borderRadius:"10px",border:"none",background:" #EF4D4D26",color:"red"},{activeLinkParam:g}=Z(),k=v(),T=ee(),[je,O]=i.useState(g),x=se();i.useEffect(()=>{O(g)},[g]),i.useEffect(()=>{O(k.pathname)},[k]);const[B,j]=i.useState(!0),[b,f]=i.useState(0),Q=s=>C({url:"/orders/get_all_order_list",method:"post",data:s}),m=te(),[c,h]=i.useState({payment_type:"All",delivery_type:"All"}),{mutate:E,isLoading:N}=M(Q,{onSuccess:s=>{if(c.payment_type=="All"){const o=new Set(r.map(t=>t.order_id)),l=s==null?void 0:s.data.data.filter(t=>!o.has(t.order_id));w(t=>{const a=new Set(l.map(n=>n.order_id));return[...t.filter(n=>!a.has(n.order_id)),...l]}),l.length===0&&j(!1)}else{const o=new Set(r.map(t=>t.order_id)),l=s==null?void 0:s.data.data.filter(t=>!o.has(t.order_id));w(t=>{const a=new Set(l.map(n=>n.order_id));return[...t.filter(n=>!a.has(n.order_id)),...l]}),l.length===0&&j(!1)}m.invalidateQueries("low_stocks_data")},onError:s=>{console.log(s)},retry:{maxAttempts:3,delay:s=>s*1e3}}),[r,w]=i.useState(i.useMemo(()=>{const s=m.getQueryData("session_id");return s?s.data:[]},[m])),[p,L]=i.useState({payment_type:"All",delivery_type:"All"});i.useEffect(()=>{if(!x)T("/login");else{f(o=>o+1);const s=new FormData;return s.append("session_id",x),s.append("page",b),s.append("payment_type",p.payment_type),s.append("order_delivery_type",p.delivery_type),s.append("recent_orders_first",1),s.append("only_new_orders",0),E(s),()=>{}}},[p]);const Y=()=>{f(o=>o+1);const s=new FormData;s.append("session_id",x),s.append("page",b),s.append("payment_type",p.payment_type),s.append("recent_orders_first",1),s.append("only_new_orders",0),E(s)},$=s=>C({url:"orders/get_bills",method:"post",data:s}),{mutate:q,isLoading:H}=M($,{onSuccess:s=>{var o,l;(o=s==null?void 0:s.data)!=null&&o.success&&V((l=s==null?void 0:s.data)==null?void 0:l.order_shipment_slip_ids),m.invalidateQueries("order_delivered")},onError:s=>{console.log(s)},retry:{maxAttempts:3,delay:s=>s*1e3}}),[u,V]=i.useState(i.useMemo(()=>{const s=m.getQueryData("session_id");return s?s.data:null},[m])),G=s=>{const o=new FormData;o.append("session_id",x),o.append("order_id",s),q(o)},[J,D]=i.useState(!1),K=s=>C({url:"orders/download_bill",method:"post",data:s}),[U,W]=i.useState(i.useMemo(()=>{const s=m.getQueryData("session_id");return s?s.data:null},[m]));return N&&b===0?e.jsx("div",{className:"h-screen grid place-items-center absolute bg-white z-20 top-0 right-0 bottom-0 left-0",children:e.jsx(P,{})}):(!r||r.length==0)&&!N&&p.delivery_type=="All"&&p.payment_type=="All"?e.jsx("p",{className:"h-[450px] text-xl text-center custom400:text-2xl sm:text-3xl text-gray-700 grid place-items-center w-full px-3",children:"Ready for Orders"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:" bg-white sm:shadow-[rgba(50,_50,_105,_0.15)_0px_2px_5px_0px,_rgba(0,_0,_0,_0.05)_0px_1px_1px_0px] mt-2 sm:mx-2 rounded-lg py-2 ",children:[e.jsxs("div",{className:"hidden  sm:flex text-2xl font-semibold lg:text-3xl m-6 ",children:[e.jsx("h1",{children:" All Orders  "}),r&&e.jsx("div",{className:"h-[40px] w-[50px] bg-[#FAE4F6] mx-2 rounded-lg grid place-items-center",children:e.jsx("span",{className:"text-[#F03BD3] text-[1.5rem]",children:(r==null?void 0:r.length)<10&&(r==null?void 0:r.length)>0?`0${r==null?void 0:r.length}`:r==null?void 0:r.length})})]}),e.jsxs("div",{className:"flex mx-1 custom400:mx-5 space-x-1  custom400:space-x-5",children:[e.jsxs("div",{className:"flex items-center w-full bg-[#5a5a5a0a] rounded-lg ",children:[e.jsx(re,{className:"text-2xl text-[#1687a7] mx-2 "}),e.jsx("input",{type:"search",name:"search",placeholder:"Search Your Products",autoComplete:"off",className:" w-full rounded-lg py-1 bg-transparent outline-none"})]}),e.jsxs("button",{className:"flex items-center p-2 px-6 btn2 bg-cyan-50",onClick:()=>D(!0),children:[e.jsx(ne,{className:"text-xl"})," ",e.jsx("p",{children:"filters"})]}),J&&e.jsxs("div",{className:"max-w-[20rem] right-0 sm:max-w-[24rem] w-full bg-white p-4 absolute sm:right-10 mt-5 rounded-xl shadow-[0_3px_10px_rgb(0,0,0,0.2)] z-50 ",children:[e.jsxs("div",{className:"flex justify-between items-center ",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Order Type"}),e.jsx(oe,{className:"text-2xl hover:text-red-500 hover:text-3xl duration-500 cursor-pointer ",onClick:()=>D(!1)})]}),e.jsx("div",{className:"flex flex-wrap gap-2 my-4",children:[1,2].map(s=>e.jsxs("label",{className:`cursor-pointer ${c.delivery_type==s?"btn1":"btn2"}`,children:[e.jsx("input",{type:"checkbox",value:s,onChange:()=>{s===1?h({...c,delivery_type:c.delivery_type===1?"All":1}):s==2&&h({...c,delivery_type:c.delivery_type===2?"All":2})},className:"hidden"}),s===1?e.jsx("span",{children:"Store Pickup"}):s===2?e.jsx("span",{children:"Delivery"}):""]},s))}),e.jsxs("div",{className:"my-7",children:[e.jsx("div",{className:"h2 text-xl font-semibold",children:"Payment Status"}),e.jsx("div",{className:"flex flex-wrap gap-2 my-4",children:["COD","ONLINE PAYMENT"].map(s=>e.jsxs("label",{className:`cursor-pointer ${c.payment_type==s?"btn1":"btn2"}`,children:[e.jsx("input",{type:"checkbox",value:s,onChange:()=>{s=="COD"?h({...c,payment_type:c.payment_type==="COD"?"All":"COD"}):s=="ONLINE PAYMENT"&&h({...c,payment_type:c.payment_type==="ONLINE PAYMENT"?"All":"ONLINE PAYMENT"})},className:"hidden"}),s==="COD"?e.jsx("span",{children:"COD"}):e.jsx("span",{children:"Paid Online"})]},s))})]}),e.jsxs("div",{className:"flex justify-between  custom300:space-x-4 my-4 flex-col custom300:flex-row ",children:[e.jsx("button",{className:"btn2",type:"button",onClick:()=>{h({...c,payment_type:"All",delivery_type:"All"}),L({...p,payment_type:"All",delivery_type:"All"}),f(0),j(!0)},children:"Cleat Filter"}),e.jsx("button",{className:"btn2 bg-cyan-50 my-4 custom300:my-0 ",type:"button",onClick:()=>{f(0),D(!1),w([]),L(c),j(!0)},children:"Apply Filter"})]})]})]}),e.jsx("div",{className:" overflow-y-scroll h-[500px] my-10 ",id:"target_this",children:e.jsx(xe,{dataLength:(r==null?void 0:r.length)||0,next:Y,hasMore:B,loader:e.jsx("div",{className:"flex items-center justify-center my-10 w-full ",children:e.jsx(P,{})}),endMessage:e.jsx("p",{className:"text-center my-4",children:b>1?e.jsx("b",{children:"No more data you have"}):e.jsx("div",{className:"h-[400px] w-full pt-[110px] font-bold text-2xl",children:"No Order Found!"})}),scrollableTarget:"target_this",children:N?e.jsx(ce,{data:[1],data2:[1,2,3,4,5]}):e.jsx("div",{children:r.map((s,o)=>{var l;return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"my-6 px-1 custom400:px-4 ",children:[e.jsxs("div",{className:" flex justify-between ",children:[e.jsxs("div",{className:"flex",children:[e.jsxs("b",{children:[" ",o+1,"."]}),"   ",e.jsxs("div",{className:"text-[#5a5a0a] sm:text-[#1687a7] ",children:[(s==null?void 0:s.order_id)&&e.jsxs("h4",{className:"sm:text-lg",children:["Order ID: ",s==null?void 0:s.order_id]}),(s==null?void 0:s.order_time)&&e.jsxs("span",{className:"hidden sm:block",children:["Order Date:"," ",A(s.order_time).toLocaleDateString()," "," ",A(s.order_time).toLocaleTimeString()]})]})]}),e.jsx("div",{className:"hidden sm:block   ",children:(s==null?void 0:s.order_delivery_type)&&e.jsxs("p",{className:"text-green-500",children:["Order Type:"," ",(s==null?void 0:s.order_delivery_type)==1?"Store Pickup":"Delivery"]})})]},o),e.jsx("br",{}),(l=s==null?void 0:s.product_details)==null?void 0:l.map((t,a)=>e.jsxs("div",{className:"flex sm:items-center sm:justify-between flex-col sm:flex-row my-4",children:[e.jsxs("div",{className:"flex sm:w-[60%]",children:[e.jsx(he,{src:t==null?void 0:t.main_image,alt:t==null?void 0:t.main_image,className:"w-[80px] h-[100px] object-contain aspect-[3/2] "}),e.jsxs("div",{className:"ml-2 mr-4 sm:mr-10",children:[t.product_title&&e.jsx("h4",{className:"text-wrap w-full my-2 text-sm c500:text-[1rem]",children:t.product_title}),t.total_price_with_tax&&e.jsxs("h4",{className:"font-semibold text-2xl",children:["₹ ",t.total_price_with_tax," "]})]})]}),e.jsx("div",{className:"hidden sm:block font-semibold text-lg capitalize ",children:e.jsxs("p",{children:[t==null?void 0:t.colour,", ",t==null?void 0:t.size]})}),e.jsxs("div",{className:"text-[#73B7CA] flex space-x-2 justify-between items-center my-4 text-sm sm:justify-center ",children:[e.jsxs("div",{className:"sm:hidden",children:["Color :",e.jsx("b",{className:"text-[#1687a7] capitalize ",children:t==null?void 0:t.colour})]}),e.jsxs("div",{className:"sm:hidden",children:["Size:",e.jsx("b",{className:"text-[#1687a7] uppercase",children:t==null?void 0:t.size})]}),(t==null?void 0:t.order_product_status)==="1"?e.jsx("button",{style:d,children:"New "}):(t==null?void 0:t.order_product_status)==="2"?e.jsxs("button",{style:d,children:["Order in process"," "]}):(t==null?void 0:t.order_product_status)==="3"?e.jsx("button",{style:d,children:"Ready for ship "}):(t==null?void 0:t.order_product_status)==="4"?e.jsx("button",{style:d,children:"On the way "}):(t==null?void 0:t.order_product_status)==="5"?e.jsxs("button",{style:d,children:["Order Delivered (in return period)"," "]}):(t==null?void 0:t.order_product_status)==="6"?e.jsx("button",{style:d,children:"Order Delivered"}):(t==null?void 0:t.order_product_status)==="7"?e.jsx("button",{style:d,children:"Returned (issued by customer)"}):(t==null?void 0:t.order_product_status)==="8"?e.jsx("button",{style:d,children:"Return picked by courier"}):(t==null?void 0:t.order_product_status)==="9"?e.jsx("button",{style:d,children:"Return delivered to seller"}):(t==null?void 0:t.order_product_status)==="10"?e.jsx("button",{style:d,children:"Refund issued (to customer & cutted payment from seller)"}):(t==null?void 0:t.order_product_status)==="11"?e.jsx("button",{style:y,children:"Cancelled by seller"}):(t==null?void 0:t.order_product_status)==="12"?e.jsx("button",{style:y,children:"Cancelled by customer"}):(t==null?void 0:t.order_product_status)==="16"?e.jsx("button",{style:y,children:"Canceled by system"}):(t==null?void 0:t.order_product_status)==="14"?e.jsx("button",{style:d,children:"Order not accepted by customer"}):(t==null?void 0:t.order_product_status)==="15"?e.jsx("button",{style:d,children:"Order not accepted by customer & delivered to seller"}):e.jsx("button",{style:y,children:"Cancelled "})]})]},a)),e.jsx("div",{className:"mt-3 mx-auto w-[96%] sm:hidden ",children:e.jsxs(le,{sx:{background:" #D0E7ED",borderRadius:"50px"},children:[e.jsx(ae,{expandIcon:e.jsx(me,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:e.jsx(R,{sx:{color:"#1687a7"},children:"Order Details"})}),e.jsx(pe,{children:e.jsxs(R,{children:[s.order_time&&e.jsxs("span",{children:["Order Date :"," ",A(s.order_time).toLocaleDateString()]}),e.jsx("br",{}),s.location&&e.jsxs("span",{children:["Location : ",s.location]}),e.jsx("br",{}),s.payment_type&&e.jsxs("span",{children:["Order Type:"," ",(s==null?void 0:s.order_delivery_type)==1?"Store Pickup":"Delivery"]})]})})]})}),e.jsxs(S.Popover,{animate:{mount:{y:0},unmount:{y:25}},children:[e.jsx(S.PopoverHandler,{onClick:()=>[G(s==null?void 0:s.order_id)],children:e.jsxs("button",{className:"btn1 sm:float-right mx-auto w-[96%] sm:w-[200px] flex items-center justify-center my-3 sm:p-[11px] p-3 rounded-xl",children:["Download Bill"," ",e.jsx(de,{className:"text-xl ml-3"})]})}),e.jsx(S.PopoverContent,{className:"w-[90%] mx-auto sm:w-[200px] mr-5 hover:outline-none",children:H?e.jsx("div",{className:"grid place-items-center",children:e.jsx(P,{})}):u?u.length>0?u.map((t,a)=>e.jsx(_e,{document:e.jsx(ye,{bill_datas:U}),fileName:"Invoice",onClick:()=>{const _=new FormData;_.append("session_id",x),_.append("order_shipment_slip_id",t),K(_).then(n=>{var I,F,z;(I=n==null?void 0:n.data)!=null&&I.success&&(W((F=n==null?void 0:n.data)==null?void 0:F.data),console.log((z=n==null?void 0:n.data)==null?void 0:z.data)),m.invalidateQueries("order_delivered")}).catch(n=>{console.log(n)})},children:e.jsxs("button",{className:`${a%2==0?"hover:bg-cyan-50 duration-500":"hover:bg-gray-50 duration-500"} hover:text-cyan-600 capitalize rounded-lg w-full flex items-center justify-between px-4 p-2 ${a===u.length-1?"":"border-b border-gray-200"}`,children:["download pdf ",a+1," ","   ",e.jsx(ie,{className:"text-xl"})]})},a)):e.jsx("p",{className:"font-semibold text-center capitalize",children:"No bill found"}):e.jsx("p",{className:"font-semibold text-center capitalize",children:"No bill found"})})]}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("hr",{})]})})})})})})]}),e.jsx("br",{})]})};export{Ae as default};
