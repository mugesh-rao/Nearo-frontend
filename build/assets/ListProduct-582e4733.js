import{r,_ as M,i as Ee,h as Me,k as S,b as Ie,j as t,L as Te,R as Oe,s as B,e as k,t as Pe}from"./index-70997a97.js";import{u as Ae,F as Le,T as Re}from"./index.esm-a1a2ea8f.js";import{b as Be}from"./index.esm-267541a1.js";import{u as Qe,a as Ue}from"./index-cd29d591.js";import{F as W,S as J,M as E}from"./Select-569c6f7c.js";import"./formControlState-a1fb9590.js";import"./useFormControl-0c2f0a6a.js";import"./List-32c2f291.js";import"./dividerClasses-1ca545a7.js";const $e=r.lazy(()=>M(()=>import("./CountryOrgin-bbca7b78.js"),["assets/CountryOrgin-bbca7b78.js","assets/index-70997a97.js","assets/index-52a015f8.css"])),Ve=r.lazy(()=>M(()=>import("./Attribute-12f6acc4.js"),["assets/Attribute-12f6acc4.js","assets/index-70997a97.js","assets/index-52a015f8.css"])),qe=r.lazy(()=>M(()=>import("./Tables-a9c8b998.js"),["assets/Tables-a9c8b998.js","assets/index-70997a97.js","assets/index-52a015f8.css","assets/Button-da6a835c.js"])),He=r.lazy(()=>M(()=>import("./MainCategory-431cc266.js"),["assets/MainCategory-431cc266.js","assets/index-70997a97.js","assets/index-52a015f8.css"])),lt=()=>{var $;const m=Ee(),I=Me(),Z=e=>k({url:"/products/add_product",method:"post",data:e}),{mutate:K,isLoading:X}=S(Z,{onSuccess:e=>{var s,l,c;((s=e==null?void 0:e.data)==null?void 0:s.success)===1?(B.success((l=e==null?void 0:e.data)==null?void 0:l.message),Y(e==null?void 0:e.data)):B.error((c=e==null?void 0:e.data)==null?void 0:c.message),m.invalidateQueries("add_products")},onError:e=>{B.error(e)},retry:{maxAttempts:3,delay:e=>e*1e3}}),[i,Y]=r.useState(r.useMemo(()=>{const e=m.getQueryData("add product");return e?e.data:null},[m])),[x,G]=r.useState([]),[ee,We]=r.useState({product_title:"",hsn_code:"",product_market_price:"",product_discount:"",gst_category_id:"",low_stock:"",return_period_time:"",product_weight:"",country_origin:"",manufactured_by:"",product_desc:""}),[h,Q]=r.useState(()=>{const e=localStorage.getItem("tabs");return e?JSON.parse(e):[{id:1,title:"Tab 1"}]}),[N,T]=r.useState(()=>{const e=localStorage.getItem("activeTab");return e?parseInt(e):1});r.useEffect(()=>{localStorage.setItem("tabs",JSON.stringify(h))},[h]),r.useEffect(()=>{localStorage.setItem("activeTab",N)},[N]),r.useCallback(()=>{const e=h.length+1,s=[...h,{id:e,title:`Tab ${e}`}];Q(s),T(e)},[h]),r.useCallback(e=>{T(e)},[N]),r.useCallback(e=>{const s=h.filter(l=>l.id!==e);Q(s),N===e&&s.length>0&&T(s[s.length-1].id)},[N,h]);const[O,P]=r.useState(!1),[g,C]=r.useState([]),[b,v]=r.useState(""),[_,z]=r.useState([]),[w,te]=r.useState([]),se=Ie();let{values:a,errors:o,touched:d,handleBlur:p,handleChange:u,handleSubmit:re}=Qe({initialValues:ee,validationSchema:Ue,onSubmit:e=>{var f,V,q,H;const s=new FormData;s.append("session_id",I),s.append("product_title",e==null?void 0:e.product_title),s.append("product_category1_id",(f=x[0])==null?void 0:f.category_id),s.append("product_category2_id",(V=x[1])==null?void 0:V.category_id),s.append("product_category3_id",(q=x[2])==null?void 0:q.category_id),s.append("product_category4_id",(H=x[3])==null?void 0:H.category_id),s.append("hsn_code",e==null?void 0:e.hsn_code),s.append("gst_category_id",e==null?void 0:e.gst_category_id),s.append("product_low_quantity_stock",e==null?void 0:e.low_stock),s.append("return_period_time",e==null?void 0:e.return_period_time),s.append("product_weight",e==null?void 0:e.product_weight),s.append("country_origin",e==null?void 0:e.country_origin),s.append("manufactured_by",e==null?void 0:e.manufactured_by),s.append("product_desc",e==null?void 0:e.product_desc),_==null||_.forEach((j,F)=>{s.append(`product_sizes[${F}][main_attribute_value_id]`,j==null?void 0:j.main_attribute_value_id),s.append(`product_sizes[${F}][mrp]`,j.mrp),s.append(`product_sizes[${F}][price]`,j.price),s.append(`product_sizes[${F}][quantity]`,j.quantity)});for(var l=0;l<w.length;l++)for(var c=0;c<w[l].length;c++)s.append("product_attributes["+l+"]["+c+"]",w[l][c]);s.append("is_variation",0),s.append("product_id",0),s.append("variation_attribute_value_id",w[0][1]),K(s)}});const A=r.useCallback((e,s)=>{const{value:l,checked:c}=e.target;c&&a.product_discount?(C([...g,l]),z([..._,{name:l,isEditing:!1,main_attribute_value_id:s,mrp:a.product_market_price,discount:a.product_discount,quantity:0,price:a.product_market_price-a.product_market_price*a.product_discount/100}]),v(b+l+", ")):(z(_.filter(f=>f.name!==l)),C(g.filter(f=>f!==l)),v(b.replace(l+", ","")))},[b,g,_,a==null?void 0:a.product_discount,a==null?void 0:a.product_market_price]),ae=r.useCallback(e=>{e.preventDefault(),P(!O),g.length==0&&A(e,49)},[O,A,g]),le=r.useCallback(e=>{e.preventDefault(),C([]),v(""),z([]),P(!1)},[]),oe=()=>{P(!1)},ce=e=>{console.log("Selected option:",e),a.country_origin=e},[ne,ie]=r.useState([]);r.useEffect(()=>{fetch("https://restcountries.com/v3.1/all").then(e=>e.json()).then(e=>ie(e.map(s=>s.name.common)))},[]);const de=e=>k({url:"datas/get_product_categories1",method:"post",data:e}),{mutate:U,isLoading:Je}=S(de,{onSuccess:e=>{var s;ue((s=e==null?void 0:e.data)==null?void 0:s.data),m.invalidateQueries("parent_category")},onError:e=>{console.log(e)},retry:{maxAttempts:3,delay:e=>e*1e3}}),[pe,ue]=r.useState(r.useMemo(()=>{const e=m.getQueryData("parent_category");return e?e.data:null},[m])),me=r.useCallback(()=>{const e=new FormData;U(e)},[U]),xe=()=>Pe.get("https://nearo.in/seller_app/index.php/seller/datas/get_gst_categories"),{isLoading:he,data:y,isError:_e,error:ge}=Ae("gstData",xe),be=S(e=>k({url:"/datas/get_product_sizes",method:"post",data:e}),{onSuccess:e=>{var s;ye((s=e==null?void 0:e.data)==null?void 0:s.data),m.invalidateQueries("product_Size")},onError:e=>{console.log(e)},retry:{maxAttempts:3,delay:e=>e*1e3}}),[L,ye]=r.useState(r.useMemo(()=>{const e=m.getQueryData("product_Size");return e?e.data:null},[m])),[fe,je]=r.useState(!0);r.useEffect(()=>{var s;const e=new FormData;e.append("category_4_id",x&&((s=x[3])==null?void 0:s.category_id)),be.mutate(e),je(!1)},[x]);const[n,R]=r.useState([]),Ne=e=>{const l=Array.from(e.target.files).filter(c=>c.type.startsWith("image/"));R([...n,...l]),console.log(l)},we=(e,s)=>{const l=e.target.files[0];if(l&&l.type.startsWith("image/")){const c=[...n];c[s]=l,R(c)}},Se=e=>{const s=n.filter((l,c)=>c!==e);R(s)},ke=e=>k({url:"/products/update_product_main_image",method:"post",data:e}),{mutate:Ce,isLoading:ve}=S(ke,{onSuccess:e=>{console.log(e==null?void 0:e.data),m.invalidateQueries("add_products")},onError:e=>{console.log(e)},retry:{maxAttempts:3,delay:e=>e*1e3}}),ze=e=>k({url:"/products/add_product_images",method:"post",data:e}),{mutate:De,isLoading:Fe}=S(ze,{onSuccess:e=>{console.log(e==null?void 0:e.data),m.invalidateQueries("add_products")},onError:e=>{console.log(e)},retry:{maxAttempts:3,delay:e=>e*1e3}});r.useEffect(()=>{const e=new FormData,s=new FormData;if(e.append("product_id",i==null?void 0:i.product_id),e.append("session_id",I),e.append("main_image",n[0]),s.append("product_id",i==null?void 0:i.product_id),s.append("session_id",I),(n==null?void 0:n.length)>0)for(var l=1;l<n.length;l++)s.append("images[]",n[l]);Ce(e),De(s),r.startTransition(()=>{i!=null&&i.product_id&&se(`/dashboard/add_product/edit/${i==null?void 0:i.product_id}`)})},[i]);const D=[{label:"1 Day",value:1},{label:"2 Days",value:2},{label:"3 Days",value:3},{label:"4 Days",value:4},{label:"5 Days",value:5},{label:"6 Days",value:6},{label:"7 Days",value:7},{label:"8 Days",value:8},{label:"9 Days",value:9},{label:"10 Days",value:10},{label:"11 Days",value:11},{label:"12 Days",value:12},{label:"13 Days",value:13},{label:"14 Days",value:14},{label:"15 Days",value:15}];return he||fe||Fe||X||ve?t.jsx("div",{className:"h-screen w-full grid place-items-center fixed z-20 top-0 right-0 bottom-0 left-0 bg-white",children:t.jsx(Te,{})}):_e?t.jsxs("h2",{className:"text-center my-20 text-3xl",children:[ge.message," "]}):t.jsx("div",{className:"bg-white mx-2 mt-2 p-1 py-4 sm:p-4",children:t.jsxs("div",{className:"py-4 sm:p-4",children:[t.jsxs("h2",{className:"text-lg sm:text-2xl font-medium my-4 flex items-center",children:["Upload Product Images",t.jsx("sup",{children:t.jsx(Le,{className:"text-[10px]"})})," "]}),t.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-2 sm:p-5 border-spacing-80    ",children:[t.jsxs("p",{className:"text-[12px] p-1 bg-gray-100 text-gray-600 px-4 w-fit",children:[t.jsx("sup",{children:"*"}),"Minimum 1 and Maximum 5 Images"," "]}),t.jsxs("div",{className:"flex space-x-6 items-center my-6",children:[(n==null?void 0:n.length)>0&&t.jsx("div",{className:"flex space-x-5",children:n==null?void 0:n.map((e,s)=>t.jsxs("div",{className:"h-20 w-20 sm:h-32 sm:w-32 relative",children:[s!==0?t.jsx(Oe,{className:"text-2xl bg-cyan-500 rounded-full text-white float-right text-right absolute -right-2 -top-2 cursor-pointer",onClick:()=>Se(s)}):"",t.jsx("img",{src:URL.createObjectURL(e),alt:`Selected ${s}`,className:"object-fill w-full h-full rounded-md border-2 border-dashed border-cyan-300"}),t.jsx("label",{htmlFor:`file-upload-${s}`,className:"capitalize text-cyan-600 underline text-sm text-center hover:text-black hover:font-semibold cursor-pointer",children:s===0?"Change Main Image":"Change Image"}),t.jsx("input",{id:`file-upload-${s}`,type:"file",multiple:!0,className:"hidden",onChange:l=>we(l,s)})]},s))}),t.jsxs("label",{htmlFor:"file-upload",className:"h-20 w-20 sm:h-32 sm:w-32 rounded-md border-2 border-dashed border-cyan-300 bg-cyan-50 text-cyan-700 flex flex-col items-center justify-center cursor-pointer",children:[t.jsx(Be,{className:"text-2xl sm:text-4xl"}),t.jsx("p",{className:"text-[10px] sm:text-[12px] ",children:" Upload File"})]}),t.jsx("input",{id:"file-upload",type:"file",className:"hidden",onChange:Ne})]})]}),t.jsx("div",{className:"my-5",children:t.jsxs("form",{action:"",className:"text-sm sm:text-lg",children:[t.jsxs("label",{htmlFor:"PRODUCT_name",className:"block sm:flex justify-between items-center ",children:[t.jsxs("p",{children:["Name",t.jsx("sup",{children:"*"})]}),t.jsx("input",{type:"text",name:"product_title",value:a.product_title,placeholder:"Enter product name",onChange:u,onBlur:p,className:"w-full my-2 p-2 py-[10px] text-sm border border-gray-300 hover:border-black rounded-sm focus: placeholder:text-gray-400 outline-none sm:w-[85%] "})]}),o.product_title&&d.product_title&&t.jsx("p",{className:"text-red-500 text-sm text-left sm:text-center capitalize",children:o.product_title}),t.jsxs("label",{htmlFor:"product_catogory",className:"block sm:flex justify-between items-center mt-4",children:[t.jsxs("p",{children:["Category",t.jsx("sup",{children:"*"})]}),t.jsx(r.Suspense,{fallback:"loading",children:t.jsx(He,{datas:pe,get_category_id:me,setCategory_last_id:G,handleChange:u,handleBlur:p,errors:o,touched:d})})]}),t.jsxs("div",{className:"flex justify-between mt-4 items-center",children:[t.jsxs("label",{htmlFor:"MRP",className:"w-[48%]",children:[t.jsxs("p",{children:["MRP",t.jsx("sup",{children:"*"})]}),t.jsx("input",{type:"number",name:"product_market_price",value:a.product_market_price,onChange:u,onBlur:p,placeholder:"MRP",className:"w-full my-2 p-2 py-[10px] text-sm border border-gray-300 hover:border-black rounded-sm focus: placeholder:text-gray-400 outline-none "}),o.product_market_price&&d.product_market_price&&t.jsx("p",{className:"text-red-500 text-sm text-left sm:text-center capitalize",children:o.product_market_price})]}),t.jsxs("label",{htmlFor:"discount",className:"w-[48%]",children:[t.jsxs("p",{children:["Discount",t.jsx("sup",{children:"*"})]}),t.jsx("input",{type:"number",placeholder:"Discount",name:"product_discount",onChange:u,onBlur:p,value:a.product_discount,className:"w-full my-2 p-2 py-[10px] text-sm border border-gray-300 hover:border-black rounded-sm focus: placeholder:text-gray-400 outline-none "}),o.product_discount&&d.product_discount&&t.jsx("p",{className:"text-red-500 text-sm text-left sm:text-center capitalize",children:o.product_discount})]})]}),t.jsxs("div",{className:"flex justify-between mt-4 items-center",children:[t.jsxs("label",{htmlFor:"SellPrice",className:"w-[48%]",children:[t.jsxs("p",{children:["Sell Price",t.jsx("sup",{children:"*"})]}),t.jsx("input",{type:"text",placeholder:"Sell Price",name:"product_price",value:Math.round(a.product_market_price-a.product_discount/100*a.product_market_price),readOnly:!0,className:"w-full my-2 p-2 py-[10px] text-sm border border-gray-300 hover:border-black rounded-sm focus: placeholder:text-gray-400 outline-none "}),o.product_price&&d.product_price&&t.jsx("p",{className:"text-red-500 text-sm text-left sm:text-center capitalize",children:o.product_price})]}),t.jsxs("label",{htmlFor:"Gst",className:"w-[48%]",children:[t.jsxs("p",{children:["Gst Category",t.jsx("sup",{children:"*"})]}),t.jsx(W,{sx:{m:"5px 0 5px 0",minWidth:"100%",border:"none","& .MuiOutlinedInput-root.Mui-focused .MuiOutlinedInput-notchedOutline":{border:"1px solid black"}},size:"small",children:t.jsxs(J,{labelId:"demo-select-small-label",id:"demo-select-small",name:"gst_category_id",value:a.gst_category_id,onChange:u,onBlur:p,children:[t.jsx(E,{value:"",children:t.jsx("em",{children:"None"})}),(y==null?void 0:y.data.data)&&(($=y==null?void 0:y.data)==null?void 0:$.data.map(e=>t.jsxs(E,{value:e.category_id,children:[e.gst_percent," %"]},e.category_id)))]})}),o.gst_category_id&&d.gst_category_id&&t.jsx("p",{className:"text-red-500 text-sm text-left sm:text-center capitalize",children:o.gst_category_id})]})]}),t.jsxs("div",{className:"flex justify-between mt-4 items-center",children:[t.jsxs("label",{htmlFor:"HSN",className:"w-[48%]",children:[t.jsxs("p",{children:["HSN Code",t.jsx("sup",{children:"*"})]}),t.jsx("input",{type:"text",placeholder:"HSN Code...",name:"hsn_code",value:a.hsn_code,onChange:u,onBlur:p,className:"w-full my-2 p-2 py-[10px] text-sm border border-gray-300 hover:border-black rounded-sm focus: placeholder:text-gray-400 outline-none "}),o.hsn_code&&d.hsn_code&&t.jsx("p",{className:"text-red-500 text-sm text-left sm:text-center capitalize",children:o.hsn_code})]}),t.jsxs("label",{htmlFor:"SIZE",className:"w-[48%]",children:[t.jsxs("p",{children:["Product Size",t.jsx("sup",{children:"*"})]}),t.jsxs("div",{className:"c500:relative",children:[t.jsx("div",{className:"w-full my-2 p-2 py-[10px] text-sm border border-gray-300 hover:border-black rounded-sm focus: placeholder:text-gray-400 outline-none cursor-pointer",onClick:ae,children:b||"Select"}),O&&L&&a.product_discount&&t.jsxs("div",{className:"absolute mt-1 left-[10%] c500:left-0 c500:w-full bg-white border z-10 border-gray-300 rounded-md shadow-sm p-2 h-[280px] c500:h-[200px]  ",children:[t.jsxs("div",{className:"flex flex-wrap space-x-2 md:space-x-5 h-[220px] c500:h-[140px] space-y-4 overflow-y-auto whitespace-nowrap ",children:[t.jsx("label",{htmlFor:""}),L&&L.map(e=>t.jsxs("label",{className:" py-1 px-4 hover:bg-cyan-50 ",children:[t.jsx("input",{type:"checkbox",name:"option",value:e.title,checked:g.includes(e.title),onChange:s=>A(s,e.id),className:" transform scale-150 mr-1 accent-cyan-700  bg-grey-700  rounded cursor-pointer"},e.id),"  ",e.title]},e.id))]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("button",{onClick:le,className:" btn1 text-sm py-[8px]",children:"Clear All"}),t.jsx("button",{onClick:oe,className:"btn2 text-sm py-1",children:"Apply"})]})]})]})]})]}),t.jsx("div",{className:"border border-blue-gray-50 my-4 overflow-x-auto whitespace-nowrap ",children:t.jsx(qe,{selectedValues:_,values:a,setSelectedValues:z,inputSizeValue:b,setInputSizeValue:v,setSelectedSizeOptions:C})}),t.jsx(r.Suspense,{fallback:"loading",children:t.jsx(Ve,{category_last_id:x,attributesID:w,setAttributeID:te})}),t.jsxs("div",{className:"flex justify-between mt-4 items-center",children:[t.jsxs("label",{htmlFor:"MRP",className:"w-[48%]",children:[t.jsxs("p",{children:["Return Time (Day)",t.jsx("sup",{children:"*"})]}),t.jsx(W,{sx:{border:"none","& .MuiOutlinedInput-root.Mui-focused .MuiOutlinedInput-notchedOutline":{border:"1px solid black"}},size:"small",className:"w-full my-2 p-2 sm:w-full",children:t.jsxs(J,{labelId:"demo-select-small-label",id:"demo-select-small",name:"return_period_time",className:"w-full my-2",value:a==null?void 0:a.return_period_time,onChange:u,onBlur:p,children:[t.jsx(E,{value:"0",children:t.jsx("em",{children:"No Return"})}),(D==null?void 0:D.length)>0&&D.map((e,s)=>t.jsxs(E,{value:e.value,children:[" ",e.label]},s))]})}),o.return_period_time&&d.return_period_time&&t.jsx("p",{className:"text-red-500 text-sm text-left sm:text-center capitalize",children:o.return_period_time})]}),t.jsxs("label",{htmlFor:"discount",className:"w-[48%]",children:[t.jsxs("p",{children:["Low Stock Alert (Quantity)",t.jsx("sup",{children:"*"})]}),t.jsx("input",{type:"number",placeholder:"Low stock alert",name:"low_stock",onChange:u,onBlur:p,value:a.low_stock,className:"w-full my-2 p-2 py-[10px] text-sm border border-gray-300 hover:border-black rounded-sm focus: placeholder:text-gray-400 outline-none"}),o.low_stock&&d.low_stock&&t.jsx("p",{className:"text-red-500 text-sm text-left sm:text-center capitalize",children:o.low_stock})]})]}),t.jsxs("div",{className:"flex justify-between mt-4 items-center",children:[t.jsxs("label",{htmlFor:"MRP",className:"w-[48%]",children:[t.jsxs("p",{children:["Product Net weight (gm)",t.jsx("sup",{children:"*"})]}),t.jsx("input",{type:"number",name:"product_weight",value:a.product_weight,onChange:u,onBlur:p,placeholder:"Product Net weight",className:"w-full my-2 p-2 py-[10px] text-sm border border-gray-300 hover:border-black rounded-sm focus: placeholder:text-gray-400 outline-none "}),o.product_weight&&d.product_weight&&t.jsx("p",{className:"text-red-500 text-sm text-left sm:text-center capitalize",children:o.product_weight})]}),t.jsxs("label",{htmlFor:"discount",className:"w-[48%]",children:[t.jsxs("p",{children:["Country Of Origin",t.jsx("sup",{children:"*"})]}),t.jsx(r.Suspense,{fallback:"loading",children:t.jsx($e,{options:ne,onSelect:ce,handleChange:u,handleBlur:p,errors:o,touched:d,values:a})})]})]}),t.jsxs("label",{htmlFor:"MANUFACTURE",children:[t.jsxs("p",{children:["Manufactured By",t.jsx("sup",{children:"*"})]}),t.jsx("input",{type:"text",onChange:u,name:"manufactured_by",onBlur:p,value:a.manufactured_by,placeholder:"Manufactured By",className:"w-full my-2 p-2 py-[10px] text-sm border border-gray-300 hover:border-black rounded-sm placeholder:text-gray-400 outline-none "}),o.manufactured_by&&d.manufactured_by&&t.jsx("p",{className:"text-red-500 text-sm text-left sm:text-center capitalize",children:o.manufactured_by})]}),t.jsxs("div",{className:"w-full my-4",children:[t.jsxs("p",{className:"my-2",children:["Product Description",t.jsx("span",{className:" text-[12px] sm:text-sm text-gray-400 ml-2",children:"(optional)"})]}),t.jsx("div",{className:"w-full h-[100px] bg-[#ECEFF1]",children:t.jsx(Re,{id:"outlined-textarea",placeholder:"Enter Product Description",name:"product_desc",value:a.product_desc,onChange:u,onBlur:p,multiline:!0,rows:5,sx:{width:"100%",height:"100%","& .MuiInputBase-root":{backgroundColor:"#ECEFF1"}}})})]}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("hr",{}),t.jsx("br",{}),t.jsxs("div",{className:"my-2 flex justify-between c500:flex-row text-sm font-semibold",children:[t.jsx("button",{type:"button",className:"btn2",onClick:()=>location.reload(),children:"Clear Details"}),t.jsx("button",{type:"submit",className:"btn1",onClick:re,children:"Submit"})]})]})})]})})};export{lt as default};
