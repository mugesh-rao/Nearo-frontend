import{b as I,h as L,r as a,i as E,k as c,j as s,L as P,H as x,C as k,e as m}from"./index-70997a97.js";import{L as u}from"./LazyLoadImage-edf60663.js";import q from"./SizeQuantity-6070164a.js";import{R as C}from"./Rating-f2c8c2d6.js";import"./Box-7aca6db8.js";import"./createBox-e30dae9b.js";function M(){const p=I(),d=L(),[l,i]=a.useState(!1),[_,h]=a.useState(""),g=e=>{i(!0),h(e)},j=e=>m({url:"/dashboard/get_top_selling_products ",method:"post",data:e}),f=e=>m({url:"/dashboard/get_low_stock_products",method:"post",data:e}),o=E(),{mutate:y,isLoading:b}=c(j,{onSuccess:e=>{var r;v((r=e==null?void 0:e.data)==null?void 0:r.data),o.invalidateQueries("session-id")},onError:e=>{console.log(e)},retry:{maxAttempts:3,delay:e=>e*1e3}}),{mutate:w,isLoading:N}=c(f,{onSuccess:e=>{var r;Q((r=e==null?void 0:e.data)==null?void 0:r.data),o.invalidateQueries("session_id")},onError:e=>{console.log(e)},retry:{maxAttempts:3,delay:e=>e*1e3}}),[t,v]=a.useState(a.useMemo(()=>{const e=o.getQueryData("session_id");return e?e.data:null},[o])),[n,Q]=a.useState(a.useMemo(()=>{const e=o.getQueryData("session_id");return e?e.data:null},[o]));return a.useEffect(()=>{if(!d)p("/login");else{const e=new FormData;e.append("session_id",d),+y(e),w(e)}},[]),b||N?s.jsx("div",{className:"h-screen w-full grid place-items-center fixed z-20 top-0 right-0 bottom-0 left-0 bg-white",children:s.jsx(P,{})}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:`shadow-[rgba(50,_50,_105,_0.15)_0px_2px_5px_0px,_rgba(0,_0,_0,_0.05)_0px_1px_1px_0px]  \r
       md:flex lg:justify-between py-10 sm:rounded-t-lg mt-5 bg-white mx-2`,children:[t&&t.length>0?s.jsxs("div",{className:" md:w-[55%]",children:[s.jsx("h2",{className:"text-lg font-semibold sm:text-2xl mx-4 ",children:"Top Selling Products"}),s.jsx("br",{}),s.jsx("div",{className:`${(t==null?void 0:t.length)>8?"h-[450px]":"h-auto"} overflow-y-scroll  border-t border-gray-400 py-1 `,children:t==null?void 0:t.map((e,r)=>s.jsx(x.Fragment,{children:s.jsxs("div",{className:"flex items-center p-2 px-0 mx-2 space-x-3 border-y border-gray-300",children:[s.jsxs("div",{className:"flex items-center w-[65%]  ",children:[s.jsxs("p",{style:{color:"rgba(0, 0, 0, 0.621)"},className:"text-sm",children:[r+1<10?`0${r+1}`:r+1,"."]}),s.jsx(u,{src:e.main_image,alt:e.main_image,className:"w-12 h-14 sm:h-[4.5rem] sm:w-16 rounded-lg mx-1 object-contain "}),s.jsxs("div",{children:[s.jsx("p",{className:"text-wrap1 text-[13px] sm:text-[15px] mx-1",children:e.product_title}),s.jsxs("div",{className:"hidden sm:flex items-center",children:[s.jsx(C,{name:"half-rating",value:e==null?void 0:e.avg_review_stars,precisio:.5,readOnly:!0}),s.jsxs("span",{className:"text-[#5a5a0a] text-[12px] mx-2",children:["(",e.num_total_reviews,")"]})]})]})]}),s.jsxs("div",{className:"flex w-[28%] text-center justify-between font-semibold sm:text-xl",children:[s.jsxs("h4",{children:[e.quantity_available," "]}),s.jsxs("h4",{children:["â‚¹ ",e.price]})]})]})},e.product_id))})]}):"",n&&n.length>0?s.jsxs("div",{className:"my-12 md:my-0 md:w-[44%] ",children:[s.jsx("h2",{className:"text-lg font-semibold mx-2 sm:text-2xl",children:"Low Stocks"}),s.jsx("br",{}),s.jsx("div",{className:`${(t==null?void 0:t.length)>8?"h-[450px]":"h-auto"} overflow-y-scroll border-t border-gray-400 py-1`,children:(n==null?void 0:n.length)>0?n==null?void 0:n.map(e=>s.jsx(x.Fragment,{children:s.jsxs("div",{className:"flex items-center p-2 mx-2 justify-between border-y border-gray-300",children:[s.jsxs("div",{className:"flex items-center w-[65%]   ",children:[s.jsx(u,{src:e.main_image,alt:e.main_image,className:"w-12 h-14 sm:h-[4.5rem] sm:w-16 rounded-lg mx-1 object-contain"}),s.jsxs("div",{className:"mx-2",children:[s.jsx("p",{className:"text-wrap1 text-[13px] sm:text-[15px]",children:e.product_title}),s.jsxs("p",{style:{color:"red"},children:[e.quantity_available," left"," "]})]})]}),s.jsx("button",{className:"text-[12px] bg-red-100 px-5 py-2 rounded-xl",onClick:r=>[g(e),r.stopPropagation()],type:"button",children:"Add Stock"})]})},e.product_id)):s.jsx("div",{className:"h-full flex items-center rounded-lg shadow-[rgba(50,_50,_105,_0.15)_0px_2px_5px_0px,_rgba(0,_0,_0,_0.05)_0px_1px_1px_0px] p-2 mx-2 my-4 justify-between",children:"No Products"})})]}):""]}),l&&s.jsx(k,{open:l,onNo:()=>i(!1),size:"small",title:"Edit Quantities",children:s.jsx(q,{product:_,setQuantityOpen:i})})]})}export{M as default};
