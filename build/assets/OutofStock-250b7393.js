import{r,h as R,b as A,i as F,k as M,j as s,m as W,L as q,p as o,A as B,q as D,C as w,e as $}from"./index-70997a97.js";import H from"./EditProduct-5267c3af.js";import Y from"./SizeQuantity-6070164a.js";import{d as T}from"./MoreVert-fe9f0345.js";import{R as G}from"./index.esm-5a71c6ac.js";import{I as J}from"./index.es-9acb4e93.js";import{L as K}from"./LazyImage-75aafd9d.js";import U from"./DynamicSkeleton-79db6147.js";import{R as V}from"./Rating-f2c8c2d6.js";import"./Box-7aca6db8.js";import"./createBox-e30dae9b.js";import"./Skeleton-1722e138.js";const xe=()=>{const[y,S]=r.useState(!0),[m,u]=r.useState(0),[h,c]=r.useState(!1),[g,f]=r.useState(!1),[j,_]=r.useState(""),k=e=>{c(!0),_(e)},P=e=>{f(!0),_(e)},z=e=>{a(`/dashboard/add_product/edit/${e}`)},d=R(),a=A(),E=e=>$({url:"/inventory/get_ots_product_list",method:"post",data:e}),x=F(),{mutate:b,isLoading:N}=M(E,{onSuccess:e=>{console.log(e==null?void 0:e.data.data);const i=new Set(t.map(n=>n.product_id)),l=e==null?void 0:e.data.data.filter(n=>!i.has(n.product_id));C(n=>{const Q=new Set(l.map(p=>p.product_id));return[...n.filter(p=>!Q.has(p.product_id)),...l]}),l.length===0&&S(!1),x.invalidateQueries("low_stocks_data")},onError:e=>{console.log(e)},retry:{maxAttempts:3,delay:e=>e*1e3}}),[t,C]=r.useState(r.useMemo(()=>{const e=x.getQueryData("session_id");return e?e.data:[]},[x]));r.useEffect(()=>{if(!d)a("/login");else{u(i=>i+1);const e=new FormData;return e.append("session_id",d),e.append("page",m),b(e),()=>{}}},[]);const L=()=>{u(i=>i+1);const e=new FormData;e.append("session_id",d),e.append("page",m),b(e)},[O,I]=r.useState(window.innerWidth);return r.useEffect(()=>{const e=()=>{I(window.innerWidth)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),(!t||t.length==0)&&!N?s.jsx("h2",{className:"h-[450px] text-xl text-center custom400:text-2xl sm:text-3xl text-gray-700 grid place-items-center w-full px-3",children:"No products in out of stock"}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:" bg-white sm:mx-2 py-8",children:[s.jsxs("div",{className:"flex justify-between mx-2 items-center",children:[s.jsxs("div",{className:"hidden  sm:flex text-2xl font-semibold lg:text-3xl ",children:[s.jsx("h1",{className:"capitalize",children:"out of stock"}),t&&s.jsx("div",{className:"h-[40px] w-[50px] bg-[#E5E2F5] mx-2 rounded-lg grid place-items-center",children:s.jsx("span",{className:"text-[#9313F8] text-[1.5rem]",children:(t==null?void 0:t.length)<10&&(t==null?void 0:t.length)>0?`0${t==null?void 0:t.length}`:t==null?void 0:t.length})})]}),s.jsx("div",{className:"flex justify-end w-full space-x-5 sm:w-fit",children:s.jsxs("button",{className:"btn2 flex items-center",onClick:()=>a("/dashboard/add_product"),children:[s.jsx(W,{})," Add product"]})})]}),s.jsx(J,{dataLength:(t==null?void 0:t.length)||0,next:L,hasMore:y,loader:s.jsx("div",{className:"flex items-center justify-center bg-white w-full",children:s.jsx(q,{})}),endMessage:s.jsx("p",{style:{textAlign:"center"},children:s.jsx("b",{children:"Yay! You have seen it all"})}),children:N?s.jsx(U,{data:[1,2,3,4,5,6,7,8]}):s.jsx("div",{className:"grid grid-cols-1 custom400:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6   gap-[7px] custom400:gap-2 md:gap-x-3 md:gap-y-5 my-10 mx-1 ",children:t&&(t==null?void 0:t.map(e=>s.jsx(s.Fragment,{children:s.jsxs("div",{className:"hover:shadow-[rgba(0,_0,_0,_0.24)_0px_3px_8px] duration-500 shadow-[0px_2px_3px_-1px_rgba(0,0,0,0.1),0px_1px_0px_0px_rgba(25,28,33,0.02),0px_0px_0px_1px_rgba(25,28,33,0.08)] rounded-lg h-[400px] cursor-pointer c500:cursor-default mx-auto w-full custom300:w-[300px] custom400:w-full",onClick:()=>[O<500?c(e):""],children:[s.jsxs("div",{className:" flex justify-between items-center z-[3] relative ",style:{height:"45px"},children:[s.jsx("p",{className:`${e!=null&&e.discount_percent?"bg-[#1687a7] text-white text-[12px] h-4 px-2 c500:h-6 pb-6 py-[5px] rounded-e-lg font-semibold  overflow-hidden":"bg-transparent h-4 px-2 c500:h-6 pb-6 py-[5px]  overflow-hidden"}`,children:(e==null?void 0:e.discount_percent)&&(e==null?void 0:e.discount_percent)}),s.jsx("div",{className:" mr-2 z-20",children:s.jsxs(o.Popover,{placement:"bottom-end",children:[s.jsx(o.PopoverHandler,{children:s.jsxs(o.Button,{className:"bg-white p-1 shadow-[0_3px_10px_rgb(0,0,0,0.2)] rounded-lg text-black",children:[" ",s.jsx(T,{})," "]})}),s.jsxs(o.PopoverContent,{className:" flex flex-col",children:[s.jsxs("span",{className:"capitalize flex items-center py-2 cursor-pointer",onClick:()=>z(e==null?void 0:e.product_id),children:[s.jsx(G,{className:"text-lg"}),"  Edit Product"]}),s.jsx("hr",{}),s.jsxs("span",{className:"capitalize flex items-center py-2 cursor-not-allowed","aria-disabled":!0,children:[s.jsx(B,{className:"text-lg"}),"   Archive Product"]})]})]})})]}),s.jsx(K,{src:e==null?void 0:e.main_image,alt:e==null?void 0:e.product_title,className:"block -z-10 object-cover -mt-[45px] aspect-[4/4] h-[240px] w-full rounded-t-lg "}),s.jsxs("div",{className:"m-2",children:[s.jsx("div",{className:"my-[3px] text-[13px] text-[#5a5a0a] ",children:s.jsx("span",{className:"text-red-500 font-semibold",children:"Out Of Stock"})}),s.jsxs("div",{className:"block ",children:[s.jsxs("h4",{className:"whitespace-nowrap text-ellipsis overflow-hidden text-sm ",children:[e==null?void 0:e.product_title," "]}),s.jsxs("div",{className:"flex items-end my-[2px]",children:[(e==null?void 0:e.mrp)&&s.jsxs("p",{className:"text-[#5a5a0a] text-[14px] line-through",children:["₹",e==null?void 0:e.mrp," "]}),"   ",s.jsxs("b",{className:"text-green-500",children:["₹",e.price]})]}),s.jsxs("p",{className:"flex items-end",children:[s.jsx(V,{name:"half-rating",value:e==null?void 0:e.avg_review_stars,precision:.5,size:"small",readOnly:!0,sx:{fontSize:"21px"}})," ",s.jsxs("span",{style:{color:"rgba(19, 19, 19, 0.458)",paddingTop:"3px",fontSize:"14px"},children:["(",e.num_total_reviews,")"," "]})]})]}),s.jsxs("div",{className:"flex justify-between space-x-1 my-2",children:[s.jsx("button",{onClick:i=>[P(e),i.stopPropagation()],className:"bg-[#1687a7] text-white w-full c500:w-[75%] flex justify-center p-[6px] pb-2 rounded-lg cursor-pointer  ",children:"Edit Quantity"}),s.jsx("div",{className:"",children:s.jsx("button",{onClick:()=>k(e),className:" border border-[#1687a7] rounded-lg w-[45px] hidden c500:flex justify-center items-center p-[6px] pb-2 ",children:s.jsx(D,{className:"text-[#1687a7] text-2xl"})})})]})]})]},e==null?void 0:e.product_id)})))})})]}),h&&s.jsx(w,{open:h,onNo:()=>c(!1),size:"medium",title:"Edit Product",children:s.jsx(H,{product:j})}),g&&s.jsx(w,{open:g,onNo:()=>f(!1),size:"small",title:"Edit Quantities",children:s.jsx(Y,{product:j})})]})};export{xe as default};
