import{r,h as R,b as A,i as q,k as F,j as t,m as M,L as W,p as c,A as D,q as $,C as N,e as B}from"./index-70997a97.js";import H from"./EditProduct-5267c3af.js";import Y from"./SizeQuantity-6070164a.js";import{d as T}from"./MoreVert-fe9f0345.js";import{R as G}from"./index.esm-5a71c6ac.js";import{I as J}from"./index.es-9acb4e93.js";import{L as K}from"./LazyImage-75aafd9d.js";import U from"./DynamicSkeleton-79db6147.js";import{R as V}from"./Rating-f2c8c2d6.js";import"./Box-7aca6db8.js";import"./createBox-e30dae9b.js";import"./Skeleton-1722e138.js";const xe=()=>{const[m,u]=r.useState(0),[y,k]=r.useState(!0),o=R(),d=A(),[h,a]=r.useState(!1),[g,f]=r.useState(!1),[j,_]=r.useState(""),S=e=>{a(!0),_(e)},z=e=>{f(!0),_(e)},P=e=>{d(`/dashboard/add_product/edit/${e}`)},E=e=>B({url:"/inventory/get_low_stock_product_list",method:"post",data:e}),x=q(),{mutate:w,isLoading:b}=F(E,{onSuccess:e=>{const i=new Set(s.map(n=>n.product_id)),p=e==null?void 0:e.data.data.filter(n=>!i.has(n.product_id));L(n=>{const Q=new Set(p.map(l=>l.product_id));return[...n.filter(l=>!Q.has(l.product_id)),...p]}),p.length===0&&k(!1),x.invalidateQueries("low_stocks_data")},onError:e=>{console.log(e)},retry:{maxAttempts:3,delay:e=>e*1e3}}),[s,L]=r.useState(r.useMemo(()=>{const e=x.getQueryData("session_id");return e?e.data:[]},[x]));r.useEffect(()=>{if(!o)d("/login");else{u(i=>i+1);const e=new FormData;return e.append("session_id",o),e.append("page",m),w(e),()=>{}}},[]);const C=()=>{u(i=>i+1);const e=new FormData;e.append("session_id",o),e.append("page",m),w(e)},[I,O]=r.useState(window.innerWidth);return r.useEffect(()=>{const e=()=>{O(window.innerWidth)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),(!s||s.length==0)&&!b?t.jsx("h2",{className:"h-[450px] text-xl text-center custom400:text-2xl sm:text-3xl text-gray-700 grid place-items-center w-full px-3",children:"No products in low stock"}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"bg-white sm:mx-2 py-8",children:[t.jsxs("div",{className:"flex justify-between mx-2 items-center",children:[t.jsxs("div",{className:"hidden  sm:flex text-2xl font-semibold lg:text-3xl ",children:[t.jsx("h1",{className:"capitalize",children:"Low stocks"}),s&&t.jsx("div",{className:"h-[40px] w-[50px] bg-[#E2F3E3] mx-2 rounded-lg grid place-items-center",children:t.jsx("span",{className:"text-[#3CA83D] text-[1.5rem]",children:(s==null?void 0:s.length)<10&&(s==null?void 0:s.length)>0?`0${s==null?void 0:s.length}`:s==null?void 0:s.length})})]}),t.jsx("div",{className:"flex  justify-end w-full space-x-5 sm:w-fit",children:t.jsxs("button",{className:"btn2 flex items-center",onClick:()=>d("/dashboard/add_product"),children:[t.jsx(M,{})," Add product"]})})]}),t.jsx(J,{dataLength:(s==null?void 0:s.length)||0,next:C,hasMore:y,loader:t.jsx("div",{className:"flex items-center justify-center bg-white w-full",children:t.jsx(W,{})}),endMessage:t.jsx("p",{style:{textAlign:"center"},children:t.jsx("b",{children:"Yay! You have seen it all"})}),children:b?t.jsx(U,{data:[1,2,3,4,5,6,7,8]}):t.jsx("div",{className:"grid grid-cols-1 custom400:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-[7px] custom400:gap-2 md:gap-x-3 md:gap-y-5 my-10 mx-1 ",children:s&&(s==null?void 0:s.map(e=>t.jsx(t.Fragment,{children:t.jsxs("div",{className:"hover:shadow-[rgba(0,_0,_0,_0.24)_0px_3px_8px] duration-500 shadow-[0px_2px_3px_-1px_rgba(0,0,0,0.1),0px_1px_0px_0px_rgba(25,28,33,0.02),0px_0px_0px_1px_rgba(25,28,33,0.08)] rounded-lg h-[400px] cursor-pointer c500:cursor-default mx-auto w-full custom300:w-[300px] custom400:w-full ",onClick:()=>[I<500?a(e):""],children:[t.jsxs("div",{className:" flex justify-between items-center z-[3] relative ",style:{height:"45px"},children:[t.jsx("p",{className:`${e!=null&&e.discount_percent?"bg-[#1687a7] text-white text-[12px] h-4 px-2 c500:h-6 pb-6 py-[5px] rounded-e-lg font-semibold  overflow-hidden":"bg-transparent h-4 px-2 c500:h-6 pb-6 py-[5px]  overflow-hidden"}`,children:(e==null?void 0:e.discount_percent)&&(e==null?void 0:e.discount_percent)}),t.jsx("div",{className:" mr-2 z-20",children:t.jsxs(c.Popover,{placement:"bottom-end",children:[t.jsx(c.PopoverHandler,{children:t.jsxs(c.Button,{className:"bg-white p-1 shadow-[0_3px_10px_rgb(0,0,0,0.2)] rounded-lg text-black",children:[" ",t.jsx(T,{})," "]})}),t.jsxs(c.PopoverContent,{className:" flex flex-col",children:[t.jsxs("span",{className:"capitalize flex items-center py-2 cursor-pointer",onClick:()=>P(e==null?void 0:e.product_id),children:[t.jsx(G,{className:"text-lg"}),"  Edit Product"]}),t.jsx("hr",{}),t.jsxs("span",{className:"capitalize flex items-center py-2 cursor-not-allowed","aria-disabled":!0,children:[t.jsx(D,{className:"text-lg"}),"   Archive Product"]})]})]})})]}),e!=null&&e.main_image?t.jsx(K,{src:e==null?void 0:e.main_image,alt:e==null?void 0:e.product_title,className:"block -z-10 object-contain -mt-[45px] aspect-[4/4] h-[240px] w-full rounded-t-lg "}):t.jsx("image",{src:e==null?void 0:e.main_image,alt:e==null?void 0:e.product_title,className:"block -z-10 object-contain -mt-[45px] aspect-[4/4] h-[240px] w-full rounded-t-lg "}),t.jsxs("div",{className:"m-2",children:[t.jsx("div",{className:"my-[3px] text-[13px] text-[#5a5a0a] ",children:t.jsx("span",{className:`${e.quantity_available==0?"text-red-600":"text-orange-500"} font-bold`,children:"Low Stock"})}),t.jsxs("div",{className:"block",children:[t.jsxs("h4",{className:"whitespace-nowrap text-ellipsis overflow-hidden text-sm ",children:[e==null?void 0:e.product_title," "]}),t.jsxs("div",{className:"flex items-end my-[2px]",children:[(e==null?void 0:e.mrp)&&t.jsxs("p",{className:"text-[#5a5a0a] text-[14px] line-through",children:["₹",e==null?void 0:e.mrp," "]}),"   ",t.jsxs("b",{className:"text-green-500",children:["₹",e.price]})]}),t.jsxs("p",{className:"flex items-end",children:[t.jsx(V,{name:"half-rating",value:e==null?void 0:e.avg_review_stars,precision:.5,size:"small",readOnly:!0,sx:{fontSize:"21px"}})," ",t.jsxs("span",{style:{color:"rgba(19, 19, 19, 0.458)",paddingTop:"3px",fontSize:"14px"},children:["(",e==null?void 0:e.num_total_reviews,")"," "]})]})]}),t.jsxs("div",{className:"flex justify-between space-x-1 my-2",children:[t.jsx("button",{onClick:i=>[z(e),i.stopPropagation()],className:"bg-[#1687a7] text-white w-full c500:w-[75%] flex justify-center p-[6px] pb-2 rounded-lg cursor-pointer  ",children:"Edit Quantity"}),t.jsx("div",{className:"",children:t.jsx("button",{onClick:()=>S(e),className:" border border-[#1687a7] rounded-lg w-[45px] hidden c500:flex justify-center items-center p-[6px] pb-2 ",children:t.jsx($,{className:"text-[#1687a7] text-2xl"})})})]})]})]},e==null?void 0:e.product_id)})))})})]}),h&&t.jsx(N,{open:h,onNo:()=>a(!1),size:"medium",title:"Edit Product",children:t.jsx(H,{product:j})}),g&&t.jsx(N,{open:g,onNo:()=>f(!1),size:"small",title:"Edit Quantities",children:t.jsx(Y,{product:j})})]})};export{xe as default};
